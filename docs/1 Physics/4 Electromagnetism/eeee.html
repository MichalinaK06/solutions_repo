<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lorentz Force Simulation</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
        }
        canvas {
            border: 1px solid #ccc;
            margin: 10px 0;
        }
    </style>
</head>
<body>
    <h1>Lorentz Force Simulation</h1>
    <p>Simulating a charged particle in different field configurations:</p>
    <canvas id="canvas1" width="400" height="400"></canvas>
    <p>1. Uniform Magnetic Field (Circular Motion)</p>
    <canvas id="canvas2" width="400" height="400"></canvas>
    <p>2. Combined Electric and Magnetic Fields (Helical + Drift)</p>
    <canvas id="canvas3" width="400" height="400"></canvas>
    <p>3. Crossed Electric and Magnetic Fields (E x B Drift)</p>

    <script>
        // Constants
        const q = 1.6e-19;  // Charge (Coulombs)
        const m = 1.67e-27; // Mass (kg)
        const dt = 1e-9;    // Time step (seconds)
        const steps = 1000; // Number of steps (reduced for simplicity)

        // Initial conditions
        const r0 = [0, 0];       // Initial position [x, y] (m)
        const v0 = [1e5, 0];     // Initial velocity [vx, vy] (m/s)

        // Field configurations
        const B = [0, 0, 1];     // Magnetic field [Bx, By, Bz] (Tesla)
        const E_zero = [0, 0, 0]; // No electric field
        const E_combined = [1e5, 0, 0]; // Electric field for combined scenario

        // Lorentz force calculation (2D simplification)
        function lorentzForce(r, v, q, m, E, B) {
            // F = q(E + v x B), a = F/m
            const vxB = [0, 0, v[0] * B[2] - v[1] * B[1]]; // 2D cross product (z-component only)
            const ax = q * (E[0] + vxB[0]) / m;
            const ay = q * (E[1] + vxB[1]) / m;
            return [ax, ay];
        }

        // Simulation function
        function simulateTrajectory(r0, v0, q, m, E, B, dt, steps) {
            const r = Array(steps).fill().map(() => [0, 0]);
            const v = Array(steps).fill().map(() => [0, 0]);
            r[0] = [...r0];
            v[0] = [...v0];

            for (let i = 0; i < steps - 1; i++) {
                const a = lorentzForce(r[i], v[i], q, m, E, B);
                v[i + 1] = [v[i][0] + a[0] * dt, v[i][1] + a[1] * dt];
                r[i + 1] = [r[i][0] + v[i][0] * dt, r[i][1] + v[i][1] * dt];
            }
            return r;
        }

        // Plotting function on canvas
        function plotTrajectory(canvasId, r, title) {
            const canvas = document.getElementById(canvasId);
            const ctx = canvas.getContext('2d');
            const scale = 1e-3; // Scale factor to fit trajectory in canvas

            ctx.beginPath();
            ctx.moveTo(200 + r[0][0] * scale, 200 - r[0][1] * scale); // Center origin
            for (let i = 1; i < r.length; i++) {
                ctx.lineTo(200 + r[i][0] * scale, 200 - r[i][1] * scale);
            }
            ctx.strokeStyle = 'blue';
            ctx.stroke();

            // Add title
            ctx.fillStyle = 'black';
            ctx.fillText(title, 10, 20);
        }

        // Run simulations and plot
        // Scenario 1: Uniform Magnetic Field
        const r1 = simulateTrajectory(r0, v0, q, m, E_zero, B, dt, steps);
        plotTrajectory('canvas1', r1, 'Uniform Magnetic Field');

        // Scenario 2: Combined Fields
        const r2 = simulateTrajectory(r0, v0, q, m, E_combined, B, dt, steps);
        plotTrajectory('canvas2', r2, 'Combined Fields');

        // Scenario 3: Crossed Fields
        const v0_crossed = [0, 1e5]; // Adjusted initial velocity for clarity
        const r3 = simulateTrajectory(r0, v0_crossed, q, m, E_combined, B, dt, steps);
        plotTrajectory('canvas3', r3, 'Crossed Fields');
    </script>
</body>
</html>